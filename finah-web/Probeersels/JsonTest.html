<html>
<head>

    <script src="../js/jsonhttprequest.min.js"></script>
    <script type="text/javascript">
        var data = '';

        function OnChange(e) {
            //first.onchange = function (e) {
            var patho = document.forms["myForm"]["pathologie"];
            var val = e.target.value;

            if (val != 'null') {
                empty(patho);

                var pat = loadData(val);
                alert(pat);
                for (var i = 0; i < pat.length; i++) {
                    //gegevens ophalen
                    //addOption("test",second);
                    addOption(pat[i].omschrijving, pat[i].id, patho);
                }
            }
        }


        function empty(select) {
            select.innerHTML = '';
        }

        function addOption(inhoud, waarde, select) {
            var option = document.createElement('option');
            option.value = waarde;
//            option.innerHTML = val;
            option.textContent = inhoud;
            //option.innerText = inhoud;
            select.appendChild(option);
        }

        function loadData() {

            var xhr;
            //xhr = new XMLHttpRequest();
            //xhr.overrideMimeType("application/json");
            xhr = new JSONHttpRequest();

            var url = "http://localhost:1695/Aandoening/1/Pathologie";

            xhr.open("GET", url, true);

            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    alert(xhr.responseText);
                    data = JSON.parse(xhr.responseText);
                    alert(data[0].Id + " " + data[0].Omschrijving);
                    document.getElementById('out').innerHTML = data[0].Id +"<br />" + data[1].Omschrijving + "<br />" ;
                    //alert(data);
                }
            };
            xhr.send(null);
            return data;

        }

    </script>
</head>
<body onload="loadData()">
<div id="out"></div>
</body>
</html>